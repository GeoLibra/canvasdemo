<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<canvas id="draw"></canvas>
</body>
</html>
<script>
    var draw=document.getElementById('draw');
    const colors=["#33B5E5","#0099CC","#AA66CC","#9933CC","#99CC00","#669900","#FFBB33","#FF8800","#FF4444","#CC0000"];
    var station_r=2;
    draw.width=1296;
    draw.height=900;
    var ctx=draw.getContext('2d');


    //读取本地数据
    var xhr=new XMLHttpRequest();
    var cityname='wuhan';
    xhr.open('get','./data/drw_'+cityname+'.json');
    xhr.send();
    xhr.onreadystatechange=function () {
        if(xhr.readyState==4&&xhr.status==200){
            var result=JSON.parse(xhr.responseText);
            var lines=result.l;
            lines.forEach(function (item) {
                var points=item.c;  //线路
                ctx.beginPath();
                ctx.strokeStyle=colors[Math.floor(Math.random()*colors.length)];
                ctx.moveTo(points[0].split(' ')[0],points[0].split(' ')[1]);
                for(var i=1;i<points.length;i++){
                    ctx.lineTo(points[i].split(' ')[0],points[i].split(' ')[1]);
//                    ctx.arc(points[i].split(' ')[0],points[i].split(' ')[1],2,0,Math.PI*2);
                }
                ctx.stroke();
                ctx.closePath();
                var stations=item.st;   //站点

                stations.forEach(function (station) {
                    var x=station.rs.split(' ')[0];
                    var y=station.rs.split(' ')[1];
                    ctx.beginPath();
                    ctx.arc(x,y,station_r,0,2*Math.PI);
                    ctx.fillText(station.n,x,y);
                    ctx.fill();
                    ctx.closePath();
                });
            })

        }
    };

</script>